From 39aa4068ab0284bfc3e9879cf73c1daf2a750446 Mon Sep 17 00:00:00 2001
From: Mario Limonciello <mario.limonciello@dell.com>
Date: Tue, 17 Mar 2020 14:22:14 -0500
Subject: [PATCH] logitech: Correctly set the protocol

Fixes updates on signed receivers.
---
 plugins/logitech-hidpp/fu-logitech-hidpp-runtime.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/plugins/logitech-hidpp/fu-logitech-hidpp-runtime.c b/plugins/logitech-hidpp/fu-logitech-hidpp-runtime.c
index c82f6e8a..74b8509b 100644
--- a/plugins/logitech-hidpp/fu-logitech-hidpp-runtime.c
+++ b/plugins/logitech-hidpp/fu-logitech-hidpp-runtime.c
@@ -229,6 +229,9 @@ fu_logitech_hidpp_runtime_setup_internal (FuDevice *device, GError **error)
 		if ((self->version_bl_major == 0x01 && config[8] >= 0x04) ||
 		    (self->version_bl_major == 0x03 && config[8] >= 0x02)) {
 			self->signed_firmware = TRUE;
+			fu_device_set_protocol (device, "com.logitech.unifyingsigned");
+		} else {
+			fu_device_set_protocol (device, "com.logitech.unifying");
 		}
 	}
 
@@ -324,5 +327,4 @@ fu_logitech_hidpp_runtime_init (FuLogitechHidPpRuntime *self)
 	fu_device_set_name (FU_DEVICE (self), "Unifying Receiver");
 	fu_device_set_summary (FU_DEVICE (self), "A miniaturised USB wireless receiver");
 	fu_device_set_remove_delay (FU_DEVICE (self), FU_DEVICE_REMOVE_DELAY_RE_ENUMERATE);
-	fu_device_set_protocol (FU_DEVICE (self), "com.logitech.unifying");
 }
-- 
2.25.1

